## 并发编程

### 背景

1. 资源利用率

   尽可能让处理器一直在工作状态。

2. 公平性

   不同用户和程序对计算机资源有着同等的使用权，处理器的时间片提供了实现公平性的基础。

3. 便利性

   比起一个程序来计算所有任务，编写多个程序，每个程序执行一个任务并在必要时相互通信更加容易。

### 优势

1. 通过提高处理器资源的利用率来提升系统吞吐率

   一方面，多个线程可以同时运行在多个处理器上；另一方面，多个线程可以在单处理器上交叉运行。

2. 模拟真实世界的建模

   将工作流分解为简单、可同步进行的工作，每份工作放在一个单独的程序中运行，只在特定位置进行同步。

3. 简化异步处理

   单个程序中要实现异步有 3 种方式：1. 阻塞式；2. 非阻塞式；3. 多线程。非阻塞虽然利于处理器利用率，但复杂性远高于阻塞式。

4. 用户界面更灵敏

   用户最关心的先处理，次要的用多线程来处理。

### 劣势

1. 安全性

   在没有充足同步的情况下，多个线程的操作执行顺序是不可预测的。要解决这个问题，必须对共享变量进行协同。

2. 活跃性

   死锁、活锁、饥饿、糟糕响应、丢失信号等问题。

3. 性能

   由于多线程程序会有活跃性问题，可能会降低程序性能。

> On Java 关于并发的四个格言：
>
> 1. 不要使用并发，除非有严格的 benchmark 来证明程序太慢了；
> 2. 没有什么是真的，一切可能都有问题；
> 3. 仅仅是它能运行，并不意味着没有问题；
> 4. 必须理解并发；